openapi: 3.0.3

info:
  title: Library Manager API
  version: 1.0.0
  contact:
    name: DEV (Napoleon Avila Ochoa)
    email: napoavi@gmail.com
  description: API for library management services.

servers:
  - url: http://localhost:8080
    description: Development environment
  - url: https://api.library.com
    description: Production environment

tags:
  - name: Library Manager
    description: API to manage books in library by different criteria

paths:
  /v1/books:
    get:
      tags:
        - Book List
      summary: List all active books
      description: List all books with status active
      operationId: getBooks
      responses:
        "200":
          description: Books successfully listed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BooksResponse"
              examples:
                success_response:
                  summary: Successful list response
                  value:
                    books:
                      - id: 5
                        title: "Book 1"
                        author: "Author 1"
                        gender: "Gender 1"
                        pages: 350
                        year: 2001
                        editorial:
                          - id: 1
                          - name: "Editorial 1"
                          - address: "Address 1"
                          - maximumBooks: 1200
                          - email: "editorial1.mail@com"
                      - id: 1
                        title: "Book 2"
                        author: "Author 2"
                        gender: "Gender 2"
                        pages: 120
                        year: 1989
                        editorial:
                          - id: 2
                          - name: "Editorial 2"
                          - address: "Address 2"
                          - maximumBooks: 860
                          - email: "editorial2.mail@com"
                      - id: 2
                        title: "Book 3"
                        author: "Author 3"
                        gender: "Gender 3"
                        pages: 500
                        year: 2021
                        editorial:
                          - id: 3
                          - name: "Editorial 3"
                          - address: "Address 3"
                          - maximumBooks: 140
                          - email: "editorial3.mail@com"
                    totalBooks: 3
                    timestamp: "2024-06-03T14:30:00Z"
        "400":
          description: Invalid sorting criteria
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                invalid_weights:
                  summary: Invalid weight values
                  value:
                    code: "INVALID_CRITERIA"
                    message: "Weight values must be non-negative numbers"
                    timestamp: "2024-06-03T14:30:00Z"
                missing_weights:
                  summary: Missing criteria weights
                  value:
                    code: "MISSING_CRITERIA"
                    message: "At least one sorting criteria weight must be provided"
                    timestamp: "2024-06-03T14:30:00Z"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                server_error:
                  summary: Internal server error
                  value:
                    code: "INTERNAL_ERROR"
                    message: "An unexpected error occurred while processing the request"
                    timestamp: "2024-06-03T14:30:00Z"
components:
  schemas:
    BooksResponse:
      type: object
      required:
        - books
        - totalBooks
        - timestamp
      properties:
        books:
          type: array
          description: List of books active
          items:
            $ref: "#/components/schemas/Book"
        totalProducts:
          type: integer
          description: Total number of books returned
          example: 6
        timestamp:
          type: string
          format: date-time
          description: Timestamp when the sorting was performed
          example: "2024-06-03T14:30:00Z"

    Book:
      type: object
      required:
        - id
        - title
        - author
        - gender
        - pages
        - editorial
      properties:
        id:
          type: integer
          format: int64
          description: Book identifier
          example: 1
        title:
          type: string
          description: title
          example: "Orgullo y prejucio"
        author:
          type: string
          description: author
          example: "Jane Austen"
        gender:
          type: string
          description: gender
          example: "Novela"
        pages:
          type: integer
          description: Number of pages
          minimum: 1
          example: 100
        year:
          type: integer
          description: Year of publish
          example: 1813
        editorial:
          $ref: "#/components/schemas/Editorial"
          description: Editorial of book

    Editorial:
      type: object
      required:
        - id
        - name
        - maximumBooks
      properties:
        id:
          type: integer
          format: int64
          description: Editorial identifier
          example: 1
        name:
          type: string
          description: name
          example: "Verbum"
        address:
          type: string
          description: address
          example: "Calle falsa 123"
        maximumBooks:
          type: integer
          description: Number of books in editorial
          minimum: -1
          example: 100
        email:
          type: string
          description: email
          example: "editorial.mail@com"

    Error:
      type: object
      required:
        - code
        - message
        - timestamp
      properties:
        code:
          type: string
          description: Error code identifier
          enum:
            - "INVALID_CRITERIA"
            - "MISSING_CRITERIA"
            - "VALIDATION_ERROR"
            - "INTERNAL_ERROR"
            - "INVALID_JSON"
            - "INVALID_PARAMETER"
          example: "INVALID_CRITERIA"
        message:
          type: string
          description: Human-readable error message
          example: "Weight values must be non-negative numbers"
        timestamp:
          type: string
          format: date-time
          description: Error timestamp
          example: "2024-06-03T14:30:00Z"
        details:
          type: object
          description: Additional error details (optional)
          additionalProperties: true
          example:
            field: "criteria.weights.sales_units"
            rejectedValue: -0.1